#!/bin/bash

start_emulator() {
    # Run Windows 10 using QEMU on Termux-X11
    qemu-system-x86_64 \
      -name WinEonix \
      -m 4G \
      -cdrom win10.iso \
      -vga std \
      -soundhw hda \
      -device usb-tablet \
      -enable-kvm \
      -display sdl \
      -cpu host \
      -smp $(nproc) \
      -net nic \
      -net user,hostfwd=tcp::3389-:3389 \
      -vnc :1
}

stop_emulator() {
    echo "Stopping WinEonix..."
    # Insert any cleanup or stop logic here if needed
    echo "WinEonix stopped."
}

echo "Welcome to WinEonix!"

# Install QEMU
echo "Installing QEMU..."
pkg install qemu-system-x86_64 -y &>/dev/null
echo "QEMU installed successfully!"

echo "To start WinEonix, type 'WinEonix'. To stop it, type '1'."

while true; do
    read input
    case $input in
        WinEonix)
            start_emulator
            ;;
        1)
            stop_emulator
            exit 0
            ;;
        *)
            echo "Invalid input. Type 'WinEonix' to start or '1' to stop."
            ;;
    esac
done
